o Below command to execute script with other user
$ansible app1 -i inventory/host_vars/ -m shell -a "/home/testuser/test.sh" --become --become-method su --become-user testuser -K
To manage a system service (which requires root privileges) when connected as a non-root user (this takes advantage of the fact that the default value of become_user is root):

- name: Ensure the httpd service is running
  service:
    name: httpd
    state: started
  become: true
To run a command as the apache user:

- name: Run a command as the apache user
  command: somecommand
  become: true
  become_user: apache
To do something as the nobody user when the shell is nologin:

- name: Run a command as nobody
  command: somecommand
  become: true
  become_method: su
  become_user: nobody
  become_flags: '-s /bin/sh'