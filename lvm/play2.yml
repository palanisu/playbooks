---
  - name: Get disk details
    hosts: app
    tasks:
      - name: Discover Disks
        debug:
          msg: /dev/{{ item.key }}
        register: disks
          #set_fact:
        #  disks: "['/dev/{{item.key}}']"
        when:
          - not item.value.partitions
          - item.key is search ("nvme0n|sd")
        ignore_errors: yes
        with_dict: "{{ ansible_devices }}"
        loop_control:
          label: "{{ item.key }}"
        

      - debug: var=disks